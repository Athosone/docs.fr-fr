---
title: Ressources et code
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: d36d30dd336bbe50b192b10a6a60d2c7e382adb8
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61981953"
---
# <a name="resources-and-code"></a><span data-ttu-id="42dbd-102">Ressources et code</span><span class="sxs-lookup"><span data-stu-id="42dbd-102">Resources and Code</span></span>
<span data-ttu-id="42dbd-103">Cette présentation décrit comment accéder aux ressources [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] ou les créer à l’aide de code au lieu de la syntaxe [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="42dbd-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="42dbd-104">Pour plus d’informations sur l’utilisation générale des ressources et sur les ressources du point de vue de la syntaxe [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], consultez [Ressources XAML](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="42dbd-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="42dbd-105">Accès aux ressources à partir du code</span><span class="sxs-lookup"><span data-stu-id="42dbd-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="42dbd-106">Les clés qui identifient les ressources, si elles sont définies en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], sont également utilisées pour récupérer des ressources spécifiques si vous demandez la ressource dans le code.</span><span class="sxs-lookup"><span data-stu-id="42dbd-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="42dbd-107">Pour récupérer une ressource à partir du code le plus simple consiste à appeler le <xref:System.Windows.FrameworkElement.FindResource%2A> ou <xref:System.Windows.FrameworkElement.TryFindResource%2A> (méthode) à partir d’objets d’infrastructure dans votre application.</span><span class="sxs-lookup"><span data-stu-id="42dbd-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="42dbd-108">La différence entre ces méthodes se situe au niveau de leur comportement quand la clé demandée est introuvable.</span><span class="sxs-lookup"><span data-stu-id="42dbd-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="42dbd-109"><xref:System.Windows.FrameworkElement.FindResource%2A> lève une exception ; <xref:System.Windows.FrameworkElement.TryFindResource%2A> ne génère pas d’exception mais retourne `null`.</span><span class="sxs-lookup"><span data-stu-id="42dbd-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="42dbd-110">Chaque méthode prend la clé de ressource comme paramètre d’entrée et retourne un objet faiblement typé.</span><span class="sxs-lookup"><span data-stu-id="42dbd-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="42dbd-111">Une clé de ressource est généralement une chaîne, mais il arrive que ce ne soit pas le cas. Pour plus d’informations, consultez la section [Utilisation d’objets comme clés](#objectaskey).</span><span class="sxs-lookup"><span data-stu-id="42dbd-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="42dbd-112">En principe, vous castez l’objet retourné en type nécessaire pour la propriété que vous définissez quand vous demandez la ressource.</span><span class="sxs-lookup"><span data-stu-id="42dbd-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="42dbd-113">La logique de recherche pour la résolution d’une ressource de code est la même que pour une référence de ressource dynamique [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="42dbd-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="42dbd-114">La recherche de ressources commence dans l’élément appelant, puis se poursuit dans les éléments parents successifs de l’arborescence logique.</span><span class="sxs-lookup"><span data-stu-id="42dbd-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="42dbd-115">La recherche se poursuit dans les ressources d’application, les thèmes et les ressources système, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="42dbd-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="42dbd-116">Une demande de code pour une ressource tient compte des changements d’exécution dans les dictionnaires de ressources qui ont pu avoir lieu à la suite du chargement du dictionnaire de ressources par [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], ainsi que des changements des ressources système en temps réel.</span><span class="sxs-lookup"><span data-stu-id="42dbd-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="42dbd-117">Voici un bref exemple de code qui recherche une ressource par clé et utilise la valeur retournée pour définir une propriété, implémentée comme un <xref:System.Windows.Controls.Primitives.ButtonBase.Click> Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="42dbd-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="42dbd-118">Une autre méthode pour l’affectation d’une référence de ressource est <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="42dbd-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="42dbd-119">Cette méthode accepte deux paramètres : la clé de la ressource et l’identificateur d’une propriété de dépendance particulière présente sur l’instance de l’élément auquel la valeur de ressource doit être assignée.</span><span class="sxs-lookup"><span data-stu-id="42dbd-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="42dbd-120">En pratique, cette méthode est la même et a l’avantage de ne pas nécessiter de cast des valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="42dbd-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="42dbd-121">Une autre façon d’accéder par programmation aux ressources consiste à accéder au contenu de la <xref:System.Windows.FrameworkElement.Resources%2A> propriété en tant que dictionnaire.</span><span class="sxs-lookup"><span data-stu-id="42dbd-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="42dbd-122">C’est aussi en accédant au dictionnaire contenu dans cette propriété que vous pouvez ajouter de nouvelles ressources aux collections existantes, vérifier si le nom d’une clé donnée est déjà utilisé dans la collection ainsi que d’autres opérations de dictionnaire/collection.</span><span class="sxs-lookup"><span data-stu-id="42dbd-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="42dbd-123">Si vous écrivez un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entièrement en code, vous pouvez également créer la collection entière dans le code, lui assigner des clés et puis affecter la collection terminée à la <xref:System.Windows.FrameworkElement.Resources%2A> propriété d’un élément établi.</span><span class="sxs-lookup"><span data-stu-id="42dbd-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="42dbd-124">Ces opérations sont décrites dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="42dbd-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="42dbd-125">Vous pouvez indexer n’importe quelle donnée <xref:System.Windows.FrameworkElement.Resources%2A> collection, à l’aide d’une clé spécifique en tant que l’index, mais vous devez être conscient que l’accès à la ressource de cette façon ne suit pas les règles d’exécution normales de résolution d’une ressource.</span><span class="sxs-lookup"><span data-stu-id="42dbd-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="42dbd-126">Vous accédez uniquement à cette collection particulière.</span><span class="sxs-lookup"><span data-stu-id="42dbd-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="42dbd-127">La recherche de ressources ne s’étend pas à la racine ou à l’application si aucun objet valide n’est trouvé au niveau de la clé demandée.</span><span class="sxs-lookup"><span data-stu-id="42dbd-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="42dbd-128">Toutefois, cette approche peut parfois améliorer les performances, précisément parce que l’étendue de la recherche de la clé est plus limitée.</span><span class="sxs-lookup"><span data-stu-id="42dbd-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="42dbd-129">Consultez la <xref:System.Windows.ResourceDictionary> classe pour plus d’informations sur la façon de travailler directement avec le dictionnaire de ressources.</span><span class="sxs-lookup"><span data-stu-id="42dbd-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="42dbd-130">Création de ressources avec du code</span><span class="sxs-lookup"><span data-stu-id="42dbd-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="42dbd-131">Si vous voulez créer une application [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] entière en code, vous voudrez vraisemblablement aussi créer des ressources de cette application en code.</span><span class="sxs-lookup"><span data-stu-id="42dbd-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="42dbd-132">Pour ce faire, créez un <xref:System.Windows.ResourceDictionary> de l’instance, puis ajoutez toutes les ressources au dictionnaire à l’aide des appels successifs à <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="42dbd-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="42dbd-133">Ensuite, utilisez le <xref:System.Windows.ResourceDictionary> ainsi créé pour définir le <xref:System.Windows.FrameworkElement.Resources%2A> propriété sur un élément qui est présent dans une portée de page, ou le <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="42dbd-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="42dbd-134">Vous pouvez également gérer le <xref:System.Windows.ResourceDictionary> en tant qu’objet autonome sans l’ajouter à un élément.</span><span class="sxs-lookup"><span data-stu-id="42dbd-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="42dbd-135">Toutefois, dans ce cas, vous devez accéder aux ressources qu’il contient par clé d’élément, comme pour un dictionnaire générique.</span><span class="sxs-lookup"><span data-stu-id="42dbd-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="42dbd-136">Un <xref:System.Windows.ResourceDictionary> qui n’est pas attaché à un élément `Resources` propriété n’existerait pas dans le cadre de l’arborescence d’éléments et n’a pas de portée dans la séquence de recherche qui peut être utilisée par <xref:System.Windows.FrameworkElement.FindResource%2A> et les méthodes associées.</span><span class="sxs-lookup"><span data-stu-id="42dbd-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="42dbd-137">Utilisation d’objets comme clés</span><span class="sxs-lookup"><span data-stu-id="42dbd-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="42dbd-138">Dans la plupart des cas d’utilisation de ressources, la clé de la ressource est une chaîne.</span><span class="sxs-lookup"><span data-stu-id="42dbd-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="42dbd-139">Toutefois, diverses fonctionnalités [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] n’utilisent pas délibérément le type chaîne pour spécifier des clés, mais définissent ce paramètre sur un objet.</span><span class="sxs-lookup"><span data-stu-id="42dbd-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="42dbd-140">Vous avez la possibilité d’indexer une ressource à l’aide d’un objet grâce à la prise en charge des thèmes et des styles [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="42dbd-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="42dbd-141">Les styles des thèmes qui deviennent le style par défaut pour un contrôle sans style sont indexés chacun par le <xref:System.Type> du contrôle auquel ils doivent s’appliquer à.</span><span class="sxs-lookup"><span data-stu-id="42dbd-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="42dbd-142">L’indexation par le type est un mécanisme de recherche fiable qui fonctionne sur les instances par défaut de chaque type de contrôle, et le type peut être détecté par réflexion et utilisé pour appliquer un style aux classes dérivées, même si le type dérivé n’a aucun style par défaut.</span><span class="sxs-lookup"><span data-stu-id="42dbd-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="42dbd-143">Vous pouvez spécifier un <xref:System.Type> clés pour une ressource définie dans [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] à l’aide de la [x : Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="42dbd-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="42dbd-144">Des extensions similaires dans d’autres cas d’utilisation de clé non-chaîne prennent en charge des fonctionnalités [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], comme l’[extension de balisage ComponentResourceKey](componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="42dbd-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="42dbd-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="42dbd-145">See also</span></span>

- [<span data-ttu-id="42dbd-146">Ressources XAML</span><span class="sxs-lookup"><span data-stu-id="42dbd-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="42dbd-147">Application d’un style et création de modèles</span><span class="sxs-lookup"><span data-stu-id="42dbd-147">Styling and Templating</span></span>](../controls/styling-and-templating.md)
