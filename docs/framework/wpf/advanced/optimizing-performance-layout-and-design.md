---
title: 'Optimisation des performances : Disposition et conception'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- layout [WPF], optimizing performance
- design considerations [WPF]
- layout pass [WPF]
ms.assetid: 005f4cda-a849-448b-916b-38d14d9a96fe
ms.openlocfilehash: 8a76dd5de9f374d77345eeab3d259624546fed7c
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59107066"
---
# <a name="optimizing-performance-layout-and-design"></a><span data-ttu-id="2c1a8-102">Optimisation des performances : Disposition et conception</span><span class="sxs-lookup"><span data-stu-id="2c1a8-102">Optimizing Performance: Layout and Design</span></span>
<span data-ttu-id="2c1a8-103">La conception de votre [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application peut influer sur ses performances en créant des charges mémoire inutiles pour calculer la disposition et valider les références d’objet.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-103">The design of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application can impact its performance by creating unnecessary overhead in calculating layout and validating object references.</span></span> <span data-ttu-id="2c1a8-104">La construction d’objets, en particulier au moment de l’exécution, peut affecter les caractéristiques de performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-104">The construction of objects, particularly at run time, can affect the performance characteristics of your application.</span></span>  
  
 <span data-ttu-id="2c1a8-105">Cette rubrique fournit des recommandations sur ces aspects des performances.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-105">This topic provides performance recommendations in these areas.</span></span>  
  
## <a name="layout"></a><span data-ttu-id="2c1a8-106">Mise en page</span><span class="sxs-lookup"><span data-stu-id="2c1a8-106">Layout</span></span>  
 <span data-ttu-id="2c1a8-107">Le terme « passe de disposition » décrit le processus de mesure et réorganisation des membres d’un <xref:System.Windows.Controls.Panel>-dérivée de collection d’objets des enfants et ensuite les dessiner à l’écran.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-107">The term "layout pass" describes the process of measuring and arranging the members of a <xref:System.Windows.Controls.Panel>-derived object's collection of children, and then drawing them onscreen.</span></span> <span data-ttu-id="2c1a8-108">La passe de disposition est un processus mathématique intensif (le nombre de calculs nécessaires est proportionnel au nombre d’enfants présents dans la collection).</span><span class="sxs-lookup"><span data-stu-id="2c1a8-108">The layout pass is a mathematically-intensive process—the larger the number of children in the collection, the greater the number of calculations required.</span></span> <span data-ttu-id="2c1a8-109">Par exemple, chaque fois qu’un enfant <xref:System.Windows.UIElement> objet dans la collection change de position, il a la possibilité de déclencher une nouvelle passe par le système de disposition.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-109">For example, each time a child <xref:System.Windows.UIElement> object in the collection changes its position, it has the potential to trigger a new pass by the layout system.</span></span> <span data-ttu-id="2c1a8-110">Compte tenu de la relation étroite entre les caractéristiques d’objet et le comportement de disposition, il est important de comprendre le type des événements qui peuvent appeler le système de disposition.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-110">Because of the close relationship between object characteristics and layout behavior, it's important to understand the type of events that can invoke the layout system.</span></span> <span data-ttu-id="2c1a8-111">Votre application sera d’autant plus performante que vous réduirez autant que possible les appels inutiles de la passe de disposition.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-111">Your application will perform better by reducing as much as possible any unnecessary invocations of the layout pass.</span></span>  
  
 <span data-ttu-id="2c1a8-112">Le système de disposition effectue deux passes pour chaque membre enfant d’une collection : une passe de mesure et une passe de réorganisation.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-112">The layout system completes two passes for each child member in a collection: a measure pass, and an arrange pass.</span></span> <span data-ttu-id="2c1a8-113">Chaque objet enfant propose sa propre implémentation substituée de le <xref:System.Windows.UIElement.Measure%2A> et <xref:System.Windows.UIElement.Arrange%2A> méthodes afin de fournir son propre comportement de disposition spécifique.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-113">Each child object provides its own overridden implementation of the <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> methods in order to provide its own specific layout behavior.</span></span> <span data-ttu-id="2c1a8-114">Pour schématiser, une disposition est un système récursif qui entraîne le dimensionnement, le positionnement et le tracé d’un élément à l’écran.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-114">At its simplest, layout is a recursive system that leads to an element being sized, positioned, and drawn onscreen.</span></span>  
  
-   <span data-ttu-id="2c1a8-115">Un enfant <xref:System.Windows.UIElement> objet commence le processus de disposition en faisant d’abord ses propriétés principales mesurées.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-115">A child <xref:System.Windows.UIElement> object begins the layout process by first having its core properties measured.</span></span>  
  
-   <span data-ttu-id="2c1a8-116">L’objet <xref:System.Windows.FrameworkElement> propriétés liées à la taille, telles que <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, et <xref:System.Windows.FrameworkElement.Margin%2A>, sont évaluées.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-116">The object's <xref:System.Windows.FrameworkElement> properties that are related to size, such as <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A>, are evaluated.</span></span>  
  
-   <span data-ttu-id="2c1a8-117"><xref:System.Windows.Controls.Panel>-logique spécifique est appliquée, telles que la <xref:System.Windows.Controls.DockPanel.Dock%2A> propriété de la <xref:System.Windows.Controls.DockPanel>, ou le <xref:System.Windows.Controls.StackPanel.Orientation%2A> propriété de la <xref:System.Windows.Controls.StackPanel>.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-117"><xref:System.Windows.Controls.Panel>-specific logic is applied, such as the <xref:System.Windows.Controls.DockPanel.Dock%2A> property of the <xref:System.Windows.Controls.DockPanel>, or the <xref:System.Windows.Controls.StackPanel.Orientation%2A> property of the <xref:System.Windows.Controls.StackPanel>.</span></span>  
  
-   <span data-ttu-id="2c1a8-118">Le contenu est réorganisé, ou positionné, après que tous les objets enfants ont été mesurés.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-118">Content is arranged, or positioned, after all child objects have been measured.</span></span>  
  
-   <span data-ttu-id="2c1a8-119">La collection d’objets enfants est dessinée à l’écran.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-119">The collection of child objects is drawn to the screen.</span></span>  
  
 <span data-ttu-id="2c1a8-120">Le processus de passe de disposition est encore appelé si l’une des actions suivantes se produit :</span><span class="sxs-lookup"><span data-stu-id="2c1a8-120">The layout pass process is invoked again if any of the following actions occur:</span></span>  
  
-   <span data-ttu-id="2c1a8-121">Un objet enfant est ajouté à la collection.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-121">A child object is added to the collection.</span></span>  
  
-   <span data-ttu-id="2c1a8-122">Un <xref:System.Windows.FrameworkElement.LayoutTransform%2A> est appliqué à l’objet enfant.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> is applied to the child object.</span></span>  
  
-   <span data-ttu-id="2c1a8-123">Le <xref:System.Windows.UIElement.UpdateLayout%2A> méthode est appelée pour l’objet enfant.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-123">The <xref:System.Windows.UIElement.UpdateLayout%2A> method is called for the child object.</span></span>  
  
-   <span data-ttu-id="2c1a8-124">Quand une modification est apportée à la valeur d’une propriété de dépendance marquée avec des métadonnées qui affectent les passes de mesure ou de réorganisation.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-124">When a change occurs to the value of a dependency property that is marked with metadata affecting the measure or arrange passes.</span></span>  
  
### <a name="use-the-most-efficient-panel-where-possible"></a><span data-ttu-id="2c1a8-125">Utiliser le panneau le plus efficace si possible</span><span class="sxs-lookup"><span data-stu-id="2c1a8-125">Use the Most Efficient Panel where Possible</span></span>  
 <span data-ttu-id="2c1a8-126">La complexité du processus de disposition est directement basée sur le comportement de disposition de la <xref:System.Windows.Controls.Panel>-éléments dérivés que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-126">The complexity of the layout process is directly based on the layout behavior of the <xref:System.Windows.Controls.Panel>-derived elements you use.</span></span> <span data-ttu-id="2c1a8-127">Par exemple, un <xref:System.Windows.Controls.Grid> ou <xref:System.Windows.Controls.StackPanel> contrôle fournit beaucoup plus de fonctionnalités qu’un <xref:System.Windows.Controls.Canvas> contrôle.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-127">For example, a <xref:System.Windows.Controls.Grid> or <xref:System.Windows.Controls.StackPanel> control provides much more functionality than a <xref:System.Windows.Controls.Canvas> control.</span></span> <span data-ttu-id="2c1a8-128">Ce choix accru de fonctionnalités se traduit par une augmentation du coût des performances.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-128">The price for this greater increase in functionality is a greater increase in performance costs.</span></span> <span data-ttu-id="2c1a8-129">Toutefois, si vous n’avez pas besoin de la fonctionnalité qui un <xref:System.Windows.Controls.Grid> fournit de contrôle, vous devez utiliser les alternatives moins coûteuses, comme un <xref:System.Windows.Controls.Canvas> ou un panneau personnalisé.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-129">However, if you do not require the functionality that a <xref:System.Windows.Controls.Grid> control provides, you should use the less costly alternatives, such as a <xref:System.Windows.Controls.Canvas> or a custom panel.</span></span>  
  
 <span data-ttu-id="2c1a8-130">Pour plus d’informations, consultez la page [Vue d’ensemble de Panel](../controls/panels-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2c1a8-130">For more information, see [Panels Overview](../controls/panels-overview.md).</span></span>  
  
### <a name="update-rather-than-replace-a-rendertransform"></a><span data-ttu-id="2c1a8-131">Mettre à jour RenderTransform au lieu de le remplacer</span><span class="sxs-lookup"><span data-stu-id="2c1a8-131">Update Rather than Replace a RenderTransform</span></span>  
 <span data-ttu-id="2c1a8-132">Vous pourrez peut-être mettre à jour un <xref:System.Windows.Media.Transform> au lieu d’en remplaçant la valeur d’un <xref:System.Windows.UIElement.RenderTransform%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-132">You may be able to update a <xref:System.Windows.Media.Transform> rather than replacing it as the value of a <xref:System.Windows.UIElement.RenderTransform%2A> property.</span></span> <span data-ttu-id="2c1a8-133">C’est notamment le cas dans les scénarios qui comportent une animation.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-133">This is particularly true in scenarios that involve animation.</span></span> <span data-ttu-id="2c1a8-134">En mettant à jour une existante <xref:System.Windows.Media.Transform>, vous évitez d’initier un calcul de disposition inutile.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-134">By updating an existing <xref:System.Windows.Media.Transform>, you avoid initiating an unnecessary layout calculation.</span></span>  
  
### <a name="build-your-tree-top-down"></a><span data-ttu-id="2c1a8-135">Générer votre arborescence de haut en bas</span><span class="sxs-lookup"><span data-stu-id="2c1a8-135">Build Your Tree Top-Down</span></span>  
 <span data-ttu-id="2c1a8-136">Quand un nœud est ajouté ou supprimé de l’arborescence logique, des invalidations de propriété sont déclenchées sur le parent du nœud et tous ses enfants.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-136">When a node is added or removed from the logical tree, property invalidations are raised on the node's parent and all its children.</span></span> <span data-ttu-id="2c1a8-137">De ce fait, il convient de toujours suivre un modèle de construction de haut en bas pour éviter le coût d’invalidations inutiles sur des nœuds qui ont déjà été validés.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-137">As a result, a top-down construction pattern should always be followed to avoid the cost of unnecessary invalidations on nodes that have already been validated.</span></span> <span data-ttu-id="2c1a8-138">Le tableau suivant montre la différence de vitesse d’exécution entre la génération d’une arborescence de haut en bas et bas en haut, où l’arborescence comprend 150 niveaux avec une seule <xref:System.Windows.Controls.TextBlock> et <xref:System.Windows.Controls.DockPanel> à chaque niveau.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-138">The following table shows the difference in execution speed between building a tree top-down versus bottom-up, where the tree is 150 levels deep with a single <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Controls.DockPanel> at each level.</span></span>  
  
|<span data-ttu-id="2c1a8-139">**Action**</span><span class="sxs-lookup"><span data-stu-id="2c1a8-139">**Action**</span></span>|<span data-ttu-id="2c1a8-140">**Construction d’arborescence (en ms)**</span><span class="sxs-lookup"><span data-stu-id="2c1a8-140">**Tree building (in ms)**</span></span>|<span data-ttu-id="2c1a8-141">**Rendu — construction d’arborescence incluse (en ms)**</span><span class="sxs-lookup"><span data-stu-id="2c1a8-141">**Render—includes tree building (in ms)**</span></span>|  
|----------------|---------------------------------|-------------------------------------------------|  
|<span data-ttu-id="2c1a8-142">De bas en haut</span><span class="sxs-lookup"><span data-stu-id="2c1a8-142">Bottom-up</span></span>|<span data-ttu-id="2c1a8-143">366</span><span class="sxs-lookup"><span data-stu-id="2c1a8-143">366</span></span>|<span data-ttu-id="2c1a8-144">454</span><span class="sxs-lookup"><span data-stu-id="2c1a8-144">454</span></span>|  
|<span data-ttu-id="2c1a8-145">De haut en bas</span><span class="sxs-lookup"><span data-stu-id="2c1a8-145">Top-down</span></span>|<span data-ttu-id="2c1a8-146">11</span><span class="sxs-lookup"><span data-stu-id="2c1a8-146">11</span></span>|<span data-ttu-id="2c1a8-147">96</span><span class="sxs-lookup"><span data-stu-id="2c1a8-147">96</span></span>|  
  
 <span data-ttu-id="2c1a8-148">L’exemple de code suivant montre comment créer une arborescence de haut en bas.</span><span class="sxs-lookup"><span data-stu-id="2c1a8-148">The following code example demonstrates how to create a tree top down.</span></span>  
  
 [!code-csharp[Performance#PerformanceSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml.cs#performancesnippet1)]
 [!code-vb[Performance#PerformanceSnippet1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/Performance/visualbasic/window1.xaml.vb#performancesnippet1)]  
  
 <span data-ttu-id="2c1a8-149">Pour plus d’informations sur l’arborescence logique, consultez [Arborescences dans WPF](trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="2c1a8-149">For more information on the logical tree, see [Trees in WPF](trees-in-wpf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2c1a8-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2c1a8-150">See also</span></span>

- [<span data-ttu-id="2c1a8-151">Optimisation des performances des applications WPF</span><span class="sxs-lookup"><span data-stu-id="2c1a8-151">Optimizing WPF Application Performance</span></span>](optimizing-wpf-application-performance.md)
- [<span data-ttu-id="2c1a8-152">Planification des performances des applications</span><span class="sxs-lookup"><span data-stu-id="2c1a8-152">Planning for Application Performance</span></span>](planning-for-application-performance.md)
- [<span data-ttu-id="2c1a8-153">Tirer parti du matériel</span><span class="sxs-lookup"><span data-stu-id="2c1a8-153">Taking Advantage of Hardware</span></span>](optimizing-performance-taking-advantage-of-hardware.md)
- [<span data-ttu-id="2c1a8-154">Graphiques 2D et acquisition d'images</span><span class="sxs-lookup"><span data-stu-id="2c1a8-154">2D Graphics and Imaging</span></span>](optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="2c1a8-155">Comportement de l’objet</span><span class="sxs-lookup"><span data-stu-id="2c1a8-155">Object Behavior</span></span>](optimizing-performance-object-behavior.md)
- [<span data-ttu-id="2c1a8-156">Ressources d'application</span><span class="sxs-lookup"><span data-stu-id="2c1a8-156">Application Resources</span></span>](optimizing-performance-application-resources.md)
- [<span data-ttu-id="2c1a8-157">Text</span><span class="sxs-lookup"><span data-stu-id="2c1a8-157">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="2c1a8-158">Liaison de données</span><span class="sxs-lookup"><span data-stu-id="2c1a8-158">Data Binding</span></span>](optimizing-performance-data-binding.md)
- [<span data-ttu-id="2c1a8-159">Autres recommandations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="2c1a8-159">Other Performance Recommendations</span></span>](optimizing-performance-other-recommendations.md)
- [<span data-ttu-id="2c1a8-160">Disposition</span><span class="sxs-lookup"><span data-stu-id="2c1a8-160">Layout</span></span>](layout.md)
