---
title: Conversion d’heures entre fuseaux horaires
ms.date: 04/10/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- times [.NET Framework], converting
- time zones [.NET Framework], conversions
- UTC times, converting
- converting times
- local time conversions
ms.assetid: a51e1a3b-c983-4320-b31a-1f9fa3cf824a
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: e08e90f61429f01f360808866fdc3d963323ba23
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61901812"
---
# <a name="converting-times-between-time-zones"></a><span data-ttu-id="be6ad-102">Conversion d’heures entre fuseaux horaires</span><span class="sxs-lookup"><span data-stu-id="be6ad-102">Converting times between time zones</span></span>

<span data-ttu-id="be6ad-103">Il devient de plus en plus important pour une application qui fonctionne avec des dates et des heures de gérer les différences entre les fuseaux horaires.</span><span class="sxs-lookup"><span data-stu-id="be6ad-103">It is becoming increasingly important for any application that works with dates and times to handle differences between time zones.</span></span> <span data-ttu-id="be6ad-104">Une application ne peut plus supposer que toutes les heures peut être exprimée en heure locale, qui est la durée disponible à partir de la <xref:System.DateTime> structure.</span><span class="sxs-lookup"><span data-stu-id="be6ad-104">An application can no longer assume that all times can be expressed in the local time, which is the time available from the <xref:System.DateTime> structure.</span></span> <span data-ttu-id="be6ad-105">Par exemple, une page web qui affiche l’heure actuelle dans la partie Est des États-Unis ne sera pas crédible pour un client d’Asie orientale.</span><span class="sxs-lookup"><span data-stu-id="be6ad-105">For example, a Web page that displays the current time in the eastern part of the United States will lack credibility to a customer in eastern Asia.</span></span> <span data-ttu-id="be6ad-106">Cette rubrique explique comment convertir les heures d’un fuseau horaire à un autre, ainsi que comment convertir <xref:System.DateTimeOffset> valeurs limitée fuseaux horaires.</span><span class="sxs-lookup"><span data-stu-id="be6ad-106">This topic explains how to convert times from one time zone to another, as well as how to convert <xref:System.DateTimeOffset> values that have limited time zone awareness.</span></span>

## <a name="converting-to-coordinated-universal-time"></a><span data-ttu-id="be6ad-107">Conversion en heure UTC</span><span class="sxs-lookup"><span data-stu-id="be6ad-107">Converting to Coordinated Universal Time</span></span>

<span data-ttu-id="be6ad-108">Le temps universel coordonné (UTC) est une norme d’heure atomique de haute précision.</span><span class="sxs-lookup"><span data-stu-id="be6ad-108">Coordinated Universal Time (UTC) is a high-precision, atomic time standard.</span></span> <span data-ttu-id="be6ad-109">Les fuseaux horaires du monde sont exprimés comme décalages positifs ou négatifs par rapport à l’heure UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-109">The world’s time zones are expressed as positive or negative offsets from UTC.</span></span> <span data-ttu-id="be6ad-110">Par conséquent, l’heure UTC fournit une sorte d’heure neutre du point de vue des fuseaux horaires.</span><span class="sxs-lookup"><span data-stu-id="be6ad-110">Thus, UTC provides a kind of time-zone free or time-zone neutral time.</span></span> <span data-ttu-id="be6ad-111">L’utilisation de l’heure UTC est recommandée lorsque la portabilité de la date et de l’heure entre les ordinateurs est importante.</span><span class="sxs-lookup"><span data-stu-id="be6ad-111">The use of UTC time is recommended when a date and time's portability across computers is important.</span></span> <span data-ttu-id="be6ad-112">(Pour plus d’informations et d’autres meilleures pratiques à l’aide de dates et heures, consultez [de codage recommandées à l’aide de DateTime dans le .NET Framework](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973825(v=msdn.10)).) La conversion de fuseaux horaires individuels en heure UTC facilite les comparaisons d’heures.</span><span class="sxs-lookup"><span data-stu-id="be6ad-112">(For details and other best practices using dates and times, see [Coding best practices using DateTime in the .NET Framework](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973825(v=msdn.10)).) Converting individual time zones to UTC makes time comparisons easy.</span></span>

> [!NOTE]
> <span data-ttu-id="be6ad-113">Vous pouvez également sérialiser un <xref:System.DateTimeOffset> structure pour représenter clairement un point unique dans le temps.</span><span class="sxs-lookup"><span data-stu-id="be6ad-113">You can also serialize a <xref:System.DateTimeOffset> structure to unambiguously represent a single point in time.</span></span> <span data-ttu-id="be6ad-114">Étant donné que <xref:System.DateTimeOffset> objets stockent une valeur de date et d’heure, ainsi que son décalage à l’heure UTC, ils représentent toujours un point particulier dans le temps par rapport au format UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-114">Because <xref:System.DateTimeOffset> objects store a date and time value along with its offset from UTC, they always represent a particular point in time in relationship to UTC.</span></span>

<span data-ttu-id="be6ad-115">Pour convertir une heure en UTC le plus simple consiste à appeler le `static` (`Shared` en Visual Basic) <xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-115">The easiest way to convert a time to UTC is to call the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="be6ad-116">La conversion exacte effectuée par la méthode dépend de la valeur de la `dateTime` du paramètre <xref:System.DateTime.Kind%2A> propriété, comme le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="be6ad-116">The exact conversion performed by the method depends on the value of the `dateTime` parameter's <xref:System.DateTime.Kind%2A> property, as the following table shows.</span></span>

| `DateTime.Kind`            | <span data-ttu-id="be6ad-117">Conversion</span><span class="sxs-lookup"><span data-stu-id="be6ad-117">Conversion</span></span>                                                                     |
| -------------------------- | ------------------------------------------------------------------------------ |
| `DateTimeKind.Local`       | <span data-ttu-id="be6ad-118">Convertit l’heure locale en heure UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-118">Converts local time to UTC.</span></span>                                                    |
| `DateTimeKind.Unspecified` | <span data-ttu-id="be6ad-119">Suppose que le paramètre `dateTime` est l’heure locale et convertit l’heure locale en heure UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-119">Assumes the `dateTime` parameter is local time and converts local time to UTC.</span></span> |
| `DateTimeKind.Utc`         | <span data-ttu-id="be6ad-120">Retourne le paramètre `dateTime` inchangé.</span><span class="sxs-lookup"><span data-stu-id="be6ad-120">Returns the `dateTime` parameter unchanged.</span></span>                                    |

<span data-ttu-id="be6ad-121">Le code suivant convertit l’heure locale actuelle en heure UTC et affiche le résultat dans la console.</span><span class="sxs-lookup"><span data-stu-id="be6ad-121">The following code converts the current local time to UTC and displays the result to the console.</span></span>

[!code-csharp[System.TimeZone2.Concepts#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#6)]
[!code-vb[System.TimeZone2.Concepts#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#6)]

<span data-ttu-id="be6ad-122">Si la valeur de date et d’heure ne représente pas l’heure locale ou UTC, la <xref:System.DateTime.ToUniversalTime%2A> méthode probablement retourne un résultat erroné.</span><span class="sxs-lookup"><span data-stu-id="be6ad-122">If the date and time value does not represent either the local time or UTC, the <xref:System.DateTime.ToUniversalTime%2A> method will likely return an erroneous result.</span></span> <span data-ttu-id="be6ad-123">Toutefois, vous pouvez utiliser la <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> méthode pour convertir la date et l’heure à partir d’un fuseau horaire spécifié.</span><span class="sxs-lookup"><span data-stu-id="be6ad-123">However, you can use the <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> method to convert the date and time from a specified time zone.</span></span> <span data-ttu-id="be6ad-124">(Pour plus d’informations sur la récupération d’un <xref:System.TimeZoneInfo> objet qui représente le fuseau horaire de destination, consultez [recherche des fuseaux horaires définis sur un système local](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md).) Le code suivant utilise la <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> méthode pour convertir l’heure UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-124">(For details on retrieving a <xref:System.TimeZoneInfo> object that represents the destination time zone, see [Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md).) The following code uses the <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> method to convert Eastern Standard Time to UTC.</span></span>

[!code-csharp[System.TimeZone2.Concepts#7](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#7)]
[!code-vb[System.TimeZone2.Concepts#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#7)]

<span data-ttu-id="be6ad-125">Notez que cette méthode lève un <xref:System.ArgumentException> si le <xref:System.DateTime> l’objet <xref:System.DateTime.Kind%2A> propriété et le fuseau horaire ne correspondent pas.</span><span class="sxs-lookup"><span data-stu-id="be6ad-125">Note that this method throws an <xref:System.ArgumentException> if the <xref:System.DateTime> object's <xref:System.DateTime.Kind%2A> property and the time zone are mismatched.</span></span> <span data-ttu-id="be6ad-126">Une incompatibilité se produit si le <xref:System.DateTime.Kind%2A> propriété est <xref:System.DateTimeKind.Local?displayProperty=nameWithType> mais le <xref:System.TimeZoneInfo> objet ne représente pas le fuseau horaire local, ou si le <xref:System.DateTime.Kind%2A> propriété est <xref:System.DateTimeKind.Utc?displayProperty=nameWithType> mais le <xref:System.TimeZoneInfo> objet n’est pas égal <xref:System.TimeZoneInfo.Utc?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="be6ad-126">A mismatch occurs if the <xref:System.DateTime.Kind%2A> property is <xref:System.DateTimeKind.Local?displayProperty=nameWithType> but the <xref:System.TimeZoneInfo> object does not represent the local time zone, or if the <xref:System.DateTime.Kind%2A> property is <xref:System.DateTimeKind.Utc?displayProperty=nameWithType> but the <xref:System.TimeZoneInfo> object does not equal <xref:System.TimeZoneInfo.Utc?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="be6ad-127">Toutes ces méthodes prennent <xref:System.DateTime> valeurs comme paramètres et retournent un <xref:System.DateTime> valeur.</span><span class="sxs-lookup"><span data-stu-id="be6ad-127">All of these methods take <xref:System.DateTime> values as parameters and return a <xref:System.DateTime> value.</span></span> <span data-ttu-id="be6ad-128">Pour <xref:System.DateTimeOffset> valeurs, le <xref:System.DateTimeOffset> structure a une <xref:System.DateTimeOffset.ToUniversalTime%2A> méthode qui convertit la date et l’heure de l’instance actuelle en heure UTC d’instance.</span><span class="sxs-lookup"><span data-stu-id="be6ad-128">For <xref:System.DateTimeOffset> values, the <xref:System.DateTimeOffset> structure has a <xref:System.DateTimeOffset.ToUniversalTime%2A> instance method that converts the date and time of the current instance to UTC.</span></span> <span data-ttu-id="be6ad-129">L’exemple suivant appelle la <xref:System.DateTimeOffset.ToUniversalTime%2A> méthode pour convertir une heure locale et plusieurs autres heures en temps universel coordonné (UTC).</span><span class="sxs-lookup"><span data-stu-id="be6ad-129">The following example calls the <xref:System.DateTimeOffset.ToUniversalTime%2A> method to convert a local time and several other times to Coordinated Universal Time (UTC).</span></span>

[!code-csharp[System.DateTimeOffset.Methods#16](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Methods/cs/Methods.cs#16)]
[!code-vb[System.DateTimeOffset.Methods#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Methods/vb/Methods.vb#16)]

## <a name="converting-utc-to-a-designated-time-zone"></a><span data-ttu-id="be6ad-130">Conversion de l’heure UTC dans un fuseau horaire désigné</span><span class="sxs-lookup"><span data-stu-id="be6ad-130">Converting UTC to a designated time zone</span></span>

<span data-ttu-id="be6ad-131">Pour convertir l’heure UTC en heure locale, consultez la section « conversion en heure UTC à Local » qui suit.</span><span class="sxs-lookup"><span data-stu-id="be6ad-131">To convert UTC to local time, see the "Converting UTC to Local Time" section that follows.</span></span> <span data-ttu-id="be6ad-132">Pour convertir l’heure UTC en heure d’un fuseau horaire que vous désignez, appelez le <xref:System.TimeZoneInfo.ConvertTimeFromUtc%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-132">To convert UTC to the time in any time zone that you designate, call the <xref:System.TimeZoneInfo.ConvertTimeFromUtc%2A> method.</span></span> <span data-ttu-id="be6ad-133">Cette méthode accepte deux paramètres :</span><span class="sxs-lookup"><span data-stu-id="be6ad-133">The method takes two parameters:</span></span>

* <span data-ttu-id="be6ad-134">L’heure UTC à convertir.</span><span class="sxs-lookup"><span data-stu-id="be6ad-134">The UTC to convert.</span></span> <span data-ttu-id="be6ad-135">Cela doit être un <xref:System.DateTime> valeur dont la propriété <xref:System.DateTime.Kind%2A> propriété est définie sur `Unspecified` ou `Utc`.</span><span class="sxs-lookup"><span data-stu-id="be6ad-135">This must be a <xref:System.DateTime> value whose <xref:System.DateTime.Kind%2A> property is set to `Unspecified` or `Utc`.</span></span>

* <span data-ttu-id="be6ad-136">Le fuseau horaire vers lequel convertir l’heure UTC.</span><span class="sxs-lookup"><span data-stu-id="be6ad-136">The time zone to convert the UTC to.</span></span>

<span data-ttu-id="be6ad-137">Le code suivant convertit l’heure UTC en heure propre au fuseau horaire Centre.</span><span class="sxs-lookup"><span data-stu-id="be6ad-137">The following code converts UTC to Central Standard Time.</span></span>

[!code-csharp[System.TimeZone2.Concepts#8](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#8)]
[!code-vb[System.TimeZone2.Concepts#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#8)]

## <a name="converting-utc-to-local-time"></a><span data-ttu-id="be6ad-138">Conversion de l’heure UTC en heure locale</span><span class="sxs-lookup"><span data-stu-id="be6ad-138">Converting UTC to local time</span></span>

<span data-ttu-id="be6ad-139">Pour convertir l’heure UTC en heure locale, appelez le <xref:System.DateTime.ToLocalTime%2A> méthode de la <xref:System.DateTime> objet dont vous souhaitez convertir l’heure.</span><span class="sxs-lookup"><span data-stu-id="be6ad-139">To convert UTC to local time, call the <xref:System.DateTime.ToLocalTime%2A> method of the <xref:System.DateTime> object whose time you want to convert.</span></span> <span data-ttu-id="be6ad-140">Le comportement exact de la méthode dépend de la valeur de l’objet <xref:System.DateTime.Kind%2A> propriété, comme le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="be6ad-140">The exact behavior of the method depends on the value of the object’s <xref:System.DateTime.Kind%2A> property, as the following table shows.</span></span>

| `DateTime.Kind`            | <span data-ttu-id="be6ad-141">Conversion</span><span class="sxs-lookup"><span data-stu-id="be6ad-141">Conversion</span></span>                                                                               |
| -------------------------- | ---------------------------------------------------------------------------------------- |
| `DateTimeKind.Local`       | <span data-ttu-id="be6ad-142">Retourne le <xref:System.DateTime> valeur inchangée.</span><span class="sxs-lookup"><span data-stu-id="be6ad-142">Returns the <xref:System.DateTime> value unchanged.</span></span>                                      |
| `DateTimeKind.Unspecified` | <span data-ttu-id="be6ad-143">Suppose que le <xref:System.DateTime> valeur est une heure UTC et convertit l’heure UTC en heure locale.</span><span class="sxs-lookup"><span data-stu-id="be6ad-143">Assumes that the <xref:System.DateTime> value is UTC and converts the UTC to local time.</span></span> |
| `DateTimeKind.Utc`         | <span data-ttu-id="be6ad-144">Convertit la <xref:System.DateTime> valeur en heure locale.</span><span class="sxs-lookup"><span data-stu-id="be6ad-144">Converts the <xref:System.DateTime> value to local time.</span></span>                                 |

> [!NOTE]
> <span data-ttu-id="be6ad-145">Le <xref:System.TimeZone.ToLocalTime%2A?displayProperty=nameWithType> méthode se comporte comme le `DateTime.ToLocalTime` (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-145">The <xref:System.TimeZone.ToLocalTime%2A?displayProperty=nameWithType> method behaves identically to the `DateTime.ToLocalTime` method.</span></span> <span data-ttu-id="be6ad-146">Il prend un seul paramètre, qui est la valeur de date et l’heure à convertir.</span><span class="sxs-lookup"><span data-stu-id="be6ad-146">It takes a single parameter, which is the date and time value to convert.</span></span>

<span data-ttu-id="be6ad-147">Vous pouvez également régler l’heure dans n’importe quel fuseau horaire désigné en heure locale à l’aide de la `static` (`Shared` en Visual Basic) <xref:System.TimeZoneInfo.ConvertTime%2A?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-147">You can also convert the time in any designated time zone to local time by using the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.ConvertTime%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="be6ad-148">Cette technique est décrite dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="be6ad-148">This technique is discussed in the next section.</span></span>

## <a name="converting-between-any-two-time-zones"></a><span data-ttu-id="be6ad-149">Conversion entre deux fuseaux horaires quelconques</span><span class="sxs-lookup"><span data-stu-id="be6ad-149">Converting between any two time zones</span></span>

<span data-ttu-id="be6ad-150">Vous pouvez convertir entre deux fuseaux horaires quelconques à l’aide d’une des deux suivantes `static` (`Shared` en Visual Basic) les méthodes de la <xref:System.TimeZoneInfo> classe :</span><span class="sxs-lookup"><span data-stu-id="be6ad-150">You can convert between any two time zones by using either of the following two `static` (`Shared` in Visual Basic) methods of the <xref:System.TimeZoneInfo> class:</span></span>

* <xref:System.TimeZoneInfo.ConvertTime%2A>

  <span data-ttu-id="be6ad-151">Paramètres de cette méthode sont la valeur de date et l’heure à convertir, un `TimeZoneInfo` objet qui représente le fuseau horaire de la valeur de date et d’heure, et un `TimeZoneInfo` objet qui représente le fuseau horaire pour convertir la valeur de date et heure.</span><span class="sxs-lookup"><span data-stu-id="be6ad-151">This method's parameters are the date and time value to convert, a `TimeZoneInfo` object that represents the time zone of the date and time value, and a `TimeZoneInfo` object that represents the time zone to convert the date and time value to.</span></span>

* <xref:System.TimeZoneInfo.ConvertTimeBySystemTimeZoneId%2A>

  <span data-ttu-id="be6ad-152">Paramètres de cette méthode sont la date et valeur d’heure à convertir l’identificateur de la date et de fuseau horaire de valeur d’heure et l’identificateur du fuseau horaire pour convertir la valeur de date et heure.</span><span class="sxs-lookup"><span data-stu-id="be6ad-152">This method's parameters are the date and time value to convert, the identifier of the date and time value's time zone, and the identifier of the time zone to convert the date and time value to.</span></span>

<span data-ttu-id="be6ad-153">Les deux méthodes requièrent que le <xref:System.DateTime.Kind%2A> propriété de la valeur de date et l’heure à convertir et le <xref:System.TimeZoneInfo> identificateur d’objet ou le fuseau horaire qui représente son fuseau horaire correspondent entre eux.</span><span class="sxs-lookup"><span data-stu-id="be6ad-153">Both methods require that the <xref:System.DateTime.Kind%2A> property of the date and time value to convert and the <xref:System.TimeZoneInfo> object or time zone identifier that represents its time zone correspond to one another.</span></span> <span data-ttu-id="be6ad-154">Sinon, une exception <xref:System.ArgumentException> est levée.</span><span class="sxs-lookup"><span data-stu-id="be6ad-154">Otherwise, an <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="be6ad-155">Par exemple, si le `Kind` propriété de la valeur de date et d’heure est `DateTimeKind.Local`, une exception est levée si le `TimeZoneInfo` objet passé en tant que paramètre à la méthode n’est pas égal à `TimeZoneInfo.Local`.</span><span class="sxs-lookup"><span data-stu-id="be6ad-155">For example, if the `Kind` property of the date and time value is `DateTimeKind.Local`, an exception is thrown if the `TimeZoneInfo` object passed as a parameter to the method is not equal to `TimeZoneInfo.Local`.</span></span> <span data-ttu-id="be6ad-156">Une exception est également levée si l’identificateur passé comme paramètre à la méthode n’est pas égal à `TimeZoneInfo.Local.Id`.</span><span class="sxs-lookup"><span data-stu-id="be6ad-156">An exception is also thrown if the identifier passed as a parameter to the method is not equal to `TimeZoneInfo.Local.Id`.</span></span>

<span data-ttu-id="be6ad-157">L’exemple suivant utilise la <xref:System.TimeZoneInfo.ConvertTime%2A> méthode pour convertir l’heure Standard d’Hawaï en heure locale.</span><span class="sxs-lookup"><span data-stu-id="be6ad-157">The following example uses the <xref:System.TimeZoneInfo.ConvertTime%2A> method to convert from Hawaiian Standard Time to local time.</span></span>

[!code-csharp[System.TimeZone2.Concepts#9](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#9)]
[!code-vb[System.TimeZone2.Concepts#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#9)]

## <a name="converting-datetimeoffset-values"></a><span data-ttu-id="be6ad-158">Conversion de valeurs DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="be6ad-158">Converting DateTimeOffset values</span></span>

<span data-ttu-id="be6ad-159">Les valeurs de date et d’heure représentées par <xref:System.DateTimeOffset> objets ne sont pas entièrement horaire prenant en charge, car l’objet est dissocié de son fuseau horaire au moment où il est instancié.</span><span class="sxs-lookup"><span data-stu-id="be6ad-159">Date and time values represented by <xref:System.DateTimeOffset> objects are not fully time-zone aware because the object is disassociated from its time zone at the time it is instantiated.</span></span> <span data-ttu-id="be6ad-160">Toutefois, dans de nombreux cas, une application doit simplement convertir une date et une heure en fonction de deux décalages différents par rapport à l’heure UTC plutôt qu’en fonction de l’heure dans des fuseaux horaires particuliers.</span><span class="sxs-lookup"><span data-stu-id="be6ad-160">However, in many cases an application simply needs to convert a date and time based on two different offsets from UTC rather than on the time in particular time zones.</span></span> <span data-ttu-id="be6ad-161">Pour effectuer cette conversion, vous pouvez appeler l’instance en cours <xref:System.DateTimeOffset.ToOffset%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-161">To perform this conversion, you can call the current instance's <xref:System.DateTimeOffset.ToOffset%2A> method.</span></span> <span data-ttu-id="be6ad-162">Paramètre unique de la méthode est le décalage de la nouvelle valeur date et heure que la méthode consiste à retourner.</span><span class="sxs-lookup"><span data-stu-id="be6ad-162">The method's single parameter is the offset of the new date and time value that the method is to return.</span></span>

<span data-ttu-id="be6ad-163">Par exemple, si la date et l’heure d’une demande de page web de l’utilisateur sont connues et sont sérialisées comme chaîne au format MM/jj/aaaa hh:mm:ss zzzz, la méthode `ReturnTimeOnServer` qui suit convertit cette valeur de date et d’heure en date et heure sur le serveur web.</span><span class="sxs-lookup"><span data-stu-id="be6ad-163">For example, if the date and time of a user request for a Web page is known and is serialized as a string in the format MM/dd/yyyy hh:mm:ss zzzz, the following `ReturnTimeOnServer` method converts this date and time value to the date and time on the Web server.</span></span>

[!code-csharp[System.DateTimeOffset.Conceptual.OffsetConversions#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/cs/TimeConversions.cs#1)]
[!code-vb[System.DateTimeOffset.Conceptual.OffsetConversions#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/vb/TimeConversions.vb#1)] 

<span data-ttu-id="be6ad-164">Si la chaîne « 1/9/2007 5:32:07 -05:00 » est transmise à la méthode, représentant la date et l’heure dans un fuseau horaire en retard de cinq heures par rapport à l’heure UTC, elle retourne 1/9/2007 3:32:07 AM -07:00 pour un serveur situé dans le fuseau horaire horaire Pacifique (É.-U.).</span><span class="sxs-lookup"><span data-stu-id="be6ad-164">If the method is passed the string "9/1/2007 5:32:07 -05:00", which represents the date and time in a time zone five hours earlier than UTC, it returns 9/1/2007 3:32:07 AM -07:00 for a server located in the U.S. Pacific Standard Time zone.</span></span>

<span data-ttu-id="be6ad-165">Le <xref:System.TimeZoneInfo> classe inclut également une surcharge de la <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29?displayProperty=nameWithType> méthode qui effectue des conversions de fuseau horaire avec <xref:System.DateTimeOffset.ToOffset(System.TimeSpan)> valeurs.</span><span class="sxs-lookup"><span data-stu-id="be6ad-165">The <xref:System.TimeZoneInfo> class also includes an overload of the <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29?displayProperty=nameWithType> method that performs time zone conversions with <xref:System.DateTimeOffset.ToOffset(System.TimeSpan)> values.</span></span> <span data-ttu-id="be6ad-166">Paramètres de la méthode sont une <xref:System.DateTimeOffset> valeur et une référence au fuseau horaire à laquelle l’heure doit être converti.</span><span class="sxs-lookup"><span data-stu-id="be6ad-166">The method's parameters are a <xref:System.DateTimeOffset> value and a reference to the time zone to which the time is to be converted.</span></span> <span data-ttu-id="be6ad-167">L’appel de méthode retourne un <xref:System.DateTimeOffset> valeur.</span><span class="sxs-lookup"><span data-stu-id="be6ad-167">The method call returns a <xref:System.DateTimeOffset> value.</span></span> <span data-ttu-id="be6ad-168">Par exemple, le `ReturnTimeOnServer` méthode dans l’exemple précédent peut être réécrit comme suit pour appeler le <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="be6ad-168">For example, the `ReturnTimeOnServer` method in the previous example could be rewritten as follows to call the <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29> method.</span></span>

[!code-csharp[System.DateTimeOffset.Conceptual.OffsetConversions#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/cs/timeconversions2.cs#2)]
[!code-vb[System.DateTimeOffset.Conceptual.OffsetConversions#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/vb/TimeConversions2.vb#2)]

## <a name="see-also"></a><span data-ttu-id="be6ad-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="be6ad-169">See also</span></span>

- <xref:System.TimeZoneInfo>
- [<span data-ttu-id="be6ad-170">Dates, heures et fuseaux horaires</span><span class="sxs-lookup"><span data-stu-id="be6ad-170">Dates, times, and time zones</span></span>](../../../docs/standard/datetime/index.md)
- [<span data-ttu-id="be6ad-171">Recherche des fuseaux horaires définis sur un système local</span><span class="sxs-lookup"><span data-stu-id="be6ad-171">Finding the time zones defined on a local system</span></span>](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)
