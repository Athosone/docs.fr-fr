---
title: Résolution de surcharge (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- Visual Basic code, procedures
- overload resolution
- procedures [Visual Basic], overloading
- procedures [Visual Basic], calling
- procedure overloading [Visual Basic], overload resolution
- signatures [Visual Basic], procedure
- overloads [Visual Basic], resolution
ms.assetid: 766115d1-4352-45fb-859f-6063e0de0ec0
ms.openlocfilehash: 4f81c7377423899c142c4270f325bbd7ed20b877
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59312239"
---
# <a name="overload-resolution-visual-basic"></a><span data-ttu-id="198b5-102">Résolution de surcharge (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="198b5-102">Overload Resolution (Visual Basic)</span></span>
<span data-ttu-id="198b5-103">Lorsque le compilateur Visual Basic rencontre un appel à une procédure qui est défini dans plusieurs versions surchargées, le compilateur doit décider de la surcharge à appeler.</span><span class="sxs-lookup"><span data-stu-id="198b5-103">When the Visual Basic compiler encounters a call to a procedure that is defined in several overloaded versions, the compiler must decide which of the overloads to call.</span></span> <span data-ttu-id="198b5-104">Il effectue cela en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="198b5-104">It does this by performing the following steps:</span></span>  
  
1. <span data-ttu-id="198b5-105">**Accessibilité.**</span><span class="sxs-lookup"><span data-stu-id="198b5-105">**Accessibility.**</span></span> <span data-ttu-id="198b5-106">Il élimine toute surcharge avec un niveau d’accès qui empêche le code appelant de l’appeler.</span><span class="sxs-lookup"><span data-stu-id="198b5-106">It eliminates any overload with an access level that prevents the calling code from calling it.</span></span>  
  
2. <span data-ttu-id="198b5-107">**Nombre de paramètres.**</span><span class="sxs-lookup"><span data-stu-id="198b5-107">**Number of Parameters.**</span></span> <span data-ttu-id="198b5-108">Il élimine les surcharges qui définit un nombre différent de paramètres que ceux spécifiés dans l’appel.</span><span class="sxs-lookup"><span data-stu-id="198b5-108">It eliminates any overload that defines a different number of parameters than are supplied in the call.</span></span>  
  
3. <span data-ttu-id="198b5-109">**Types de données de paramètre.**</span><span class="sxs-lookup"><span data-stu-id="198b5-109">**Parameter Data Types.**</span></span> <span data-ttu-id="198b5-110">Le compilateur donne la préférence de méthodes d’instance sur les méthodes d’extension.</span><span class="sxs-lookup"><span data-stu-id="198b5-110">The compiler gives instance methods preference over extension methods.</span></span> <span data-ttu-id="198b5-111">Si n’importe quelle méthode d’instance est trouvée qui nécessite uniquement des conversions pour faire correspondre l’appel de procédure étendues, toutes les méthodes d’extension sont supprimées et le compilateur continue avec uniquement les candidats de méthode d’instance.</span><span class="sxs-lookup"><span data-stu-id="198b5-111">If any instance method is found that requires only widening conversions to match the procedure call, all extension methods are dropped and the compiler continues with only the instance method candidates.</span></span> <span data-ttu-id="198b5-112">Si aucune méthode d’instance de ce type n’est trouvé, il continue avec l’instance et de méthodes d’extension.</span><span class="sxs-lookup"><span data-stu-id="198b5-112">If no such instance method is found, it continues with both instance and extension methods.</span></span>  
  
     <span data-ttu-id="198b5-113">Dans cette étape, il élimine toute surcharge pour lequel les types de données des arguments appelantes ne peut pas être convertis pour les types de paramètres définis dans la surcharge.</span><span class="sxs-lookup"><span data-stu-id="198b5-113">In this step, it eliminates any overload for which the data types of the calling arguments cannot be converted to the parameter types defined in the overload.</span></span>  
  
4. <span data-ttu-id="198b5-114">**Conversions restrictives.**</span><span class="sxs-lookup"><span data-stu-id="198b5-114">**Narrowing Conversions.**</span></span> <span data-ttu-id="198b5-115">Il élimine les surcharges qui requiert une conversion restrictive à partir des types d’argument appelant pour les types de paramètres définies.</span><span class="sxs-lookup"><span data-stu-id="198b5-115">It eliminates any overload that requires a narrowing conversion from the calling argument types to the defined parameter types.</span></span> <span data-ttu-id="198b5-116">Cela est vrai si le type commutateur de vérification ([Option Strict, instruction](../../../../visual-basic/language-reference/statements/option-strict-statement.md)) est `On` ou `Off`.</span><span class="sxs-lookup"><span data-stu-id="198b5-116">This is true whether the type checking switch ([Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md)) is `On` or `Off`.</span></span>  
  
5. <span data-ttu-id="198b5-117">**Moindre extension.**</span><span class="sxs-lookup"><span data-stu-id="198b5-117">**Least Widening.**</span></span> <span data-ttu-id="198b5-118">Le compilateur considère les surcharges restantes par paires.</span><span class="sxs-lookup"><span data-stu-id="198b5-118">The compiler considers the remaining overloads in pairs.</span></span> <span data-ttu-id="198b5-119">Pour chaque paire, il compare les types de données des paramètres définis.</span><span class="sxs-lookup"><span data-stu-id="198b5-119">For each pair, it compares the data types of the defined parameters.</span></span> <span data-ttu-id="198b5-120">Si les types dans une des surcharges de tous les s’étend à des types correspondants dans l’autre, le compilateur élimine ce dernier.</span><span class="sxs-lookup"><span data-stu-id="198b5-120">If the types in one of the overloads all widen to the corresponding types in the other, the compiler eliminates the latter.</span></span> <span data-ttu-id="198b5-121">Autrement dit, il conserve la surcharge qui nécessite le moins importante.</span><span class="sxs-lookup"><span data-stu-id="198b5-121">That is, it retains the overload that requires the least amount of widening.</span></span>  
  
6. <span data-ttu-id="198b5-122">**Candidat unique.**</span><span class="sxs-lookup"><span data-stu-id="198b5-122">**Single Candidate.**</span></span> <span data-ttu-id="198b5-123">Il continue à rassembler les surcharges par paires jusqu'à ce que la seule surcharge et il résout l’appel à cette surcharge.</span><span class="sxs-lookup"><span data-stu-id="198b5-123">It continues considering overloads in pairs until only one overload remains, and it resolves the call to that overload.</span></span> <span data-ttu-id="198b5-124">Si le compilateur ne peut pas réduire la surcharge à un seul candidat, il génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="198b5-124">If the compiler cannot reduce the overloads to a single candidate, it generates an error.</span></span>  
  
 <span data-ttu-id="198b5-125">L’illustration suivante montre le processus qui détermine un ensemble de versions surchargées à appeler.</span><span class="sxs-lookup"><span data-stu-id="198b5-125">The following illustration shows the process that determines which of a set of overloaded versions to call.</span></span>  
  
 <span data-ttu-id="198b5-126">![Diagramme de flux de processus de résolution de surcharge](./media/overload-resolution/determine-overloaded-version.gif "résolution parmi des versions surchargées")</span><span class="sxs-lookup"><span data-stu-id="198b5-126">![Flow diagram of overload resolution process](./media/overload-resolution/determine-overloaded-version.gif "Resolving among overloaded versions")</span></span>    
  
 <span data-ttu-id="198b5-127">L’exemple suivant illustre ce processus de résolution de surcharge.</span><span class="sxs-lookup"><span data-stu-id="198b5-127">The following example illustrates this overload resolution process.</span></span>  
  
 [!code-vb[VbVbcnProcedures#62](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#62)]  
  
 [!code-vb[VbVbcnProcedures#63](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#63)]  
  
 <span data-ttu-id="198b5-128">Dans le premier appel, le compilateur élimine la première surcharge, car le type du premier argument (`Short`) restreint au type du paramètre correspondant (`Byte`).</span><span class="sxs-lookup"><span data-stu-id="198b5-128">In the first call, the compiler eliminates the first overload because the type of the first argument (`Short`) narrows to the type of the corresponding parameter (`Byte`).</span></span> <span data-ttu-id="198b5-129">Il élimine ensuite la troisième surcharge, car chaque argument de type dans la deuxième surcharge (`Short` et `Single`) s’étend au type correspondant dans la troisième surcharge (`Integer` et `Single`).</span><span class="sxs-lookup"><span data-stu-id="198b5-129">It then eliminates the third overload because each argument type in the second overload (`Short` and `Single`) widens to the corresponding type in the third overload (`Integer` and `Single`).</span></span> <span data-ttu-id="198b5-130">La deuxième surcharge requiert une extension moins importante, donc le compilateur utilise pour l’appel.</span><span class="sxs-lookup"><span data-stu-id="198b5-130">The second overload requires less widening, so the compiler uses it for the call.</span></span>  
  
 <span data-ttu-id="198b5-131">Dans le deuxième appel, le compilateur ne peut pas éliminer une des surcharges sur la base de conversions restrictives.</span><span class="sxs-lookup"><span data-stu-id="198b5-131">In the second call, the compiler cannot eliminate any of the overloads on the basis of narrowing.</span></span> <span data-ttu-id="198b5-132">Il élimine la troisième surcharge pour la même raison, comme dans le premier appel, car elle peut appeler la deuxième surcharge avec une extension moins importante des types d’arguments.</span><span class="sxs-lookup"><span data-stu-id="198b5-132">It eliminates the third overload for the same reason as in the first call, because it can call the second overload with less widening of the argument types.</span></span> <span data-ttu-id="198b5-133">Toutefois, le compilateur ne peut pas résoudre entre les premier et deuxième surcharges.</span><span class="sxs-lookup"><span data-stu-id="198b5-133">However, the compiler cannot resolve between the first and second overloads.</span></span> <span data-ttu-id="198b5-134">Chacun a un type de paramètre défini qui s’étend au type correspondant dans l’autre (`Byte` à `Short`, mais `Single` à `Double`).</span><span class="sxs-lookup"><span data-stu-id="198b5-134">Each has one defined parameter type that widens to the corresponding type in the other (`Byte` to `Short`, but `Single` to `Double`).</span></span> <span data-ttu-id="198b5-135">Par conséquent, le compilateur génère une erreur de résolution de surcharge.</span><span class="sxs-lookup"><span data-stu-id="198b5-135">The compiler therefore generates an overload resolution error.</span></span>  
  
## <a name="overloaded-optional-and-paramarray-arguments"></a><span data-ttu-id="198b5-136">Surchargé facultatif et Arguments ParamArray</span><span class="sxs-lookup"><span data-stu-id="198b5-136">Overloaded Optional and ParamArray Arguments</span></span>  
 <span data-ttu-id="198b5-137">Si deux surcharges d’une procédure ont des signatures identiques, mais que le dernier paramètre est déclaré [facultatif](../../../../visual-basic/language-reference/modifiers/optional.md) dans un et [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) dans l’autre, le compilateur résout un appel à cette procédure en tant que suit :</span><span class="sxs-lookup"><span data-stu-id="198b5-137">If two overloads of a procedure have identical signatures except that the last parameter is declared [Optional](../../../../visual-basic/language-reference/modifiers/optional.md) in one and [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) in the other, the compiler resolves a call to that procedure as follows:</span></span>  
  
|<span data-ttu-id="198b5-138">Si l’appel fournit le dernier argument en tant que</span><span class="sxs-lookup"><span data-stu-id="198b5-138">If the call supplies the last argument as</span></span>|<span data-ttu-id="198b5-139">Le compilateur résout l’appel à la surcharge en déclarant le dernier argument en tant que</span><span class="sxs-lookup"><span data-stu-id="198b5-139">The compiler resolves the call to the overload declaring the last argument as</span></span>|  
|---|---|  
|<span data-ttu-id="198b5-140">Aucune valeur (argument omis)</span><span class="sxs-lookup"><span data-stu-id="198b5-140">No value (argument omitted)</span></span>|`Optional`|  
|<span data-ttu-id="198b5-141">Une valeur unique</span><span class="sxs-lookup"><span data-stu-id="198b5-141">A single value</span></span>|`Optional`|  
|<span data-ttu-id="198b5-142">Deux ou plusieurs valeurs dans une liste séparée par des virgules</span><span class="sxs-lookup"><span data-stu-id="198b5-142">Two or more values in a comma-separated list</span></span>|`ParamArray`|  
|<span data-ttu-id="198b5-143">Un tableau d’une longueur quelconque (y compris un tableau vide)</span><span class="sxs-lookup"><span data-stu-id="198b5-143">An array of any length (including an empty array)</span></span>|`ParamArray`|  
  
## <a name="see-also"></a><span data-ttu-id="198b5-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="198b5-144">See also</span></span>

- [<span data-ttu-id="198b5-145">Paramètres facultatifs</span><span class="sxs-lookup"><span data-stu-id="198b5-145">Optional Parameters</span></span>](./optional-parameters.md)
- [<span data-ttu-id="198b5-146">tableaux de paramètres</span><span class="sxs-lookup"><span data-stu-id="198b5-146">Parameter Arrays</span></span>](./parameter-arrays.md)
- [<span data-ttu-id="198b5-147">Surcharge de procédure</span><span class="sxs-lookup"><span data-stu-id="198b5-147">Procedure Overloading</span></span>](./procedure-overloading.md)
- [<span data-ttu-id="198b5-148">Procédures de dépannage</span><span class="sxs-lookup"><span data-stu-id="198b5-148">Troubleshooting Procedures</span></span>](./troubleshooting-procedures.md)
- [<span data-ttu-id="198b5-149">Guide pratique pour Définir plusieurs Versions d’une procédure</span><span class="sxs-lookup"><span data-stu-id="198b5-149">How to: Define Multiple Versions of a Procedure</span></span>](./how-to-define-multiple-versions-of-a-procedure.md)
- [<span data-ttu-id="198b5-150">Guide pratique pour Appeler une procédure surchargée</span><span class="sxs-lookup"><span data-stu-id="198b5-150">How to: Call an Overloaded Procedure</span></span>](./how-to-call-an-overloaded-procedure.md)
- [<span data-ttu-id="198b5-151">Guide pratique pour Surcharger une procédure qui accepte des paramètres optionnels</span><span class="sxs-lookup"><span data-stu-id="198b5-151">How to: Overload a Procedure that Takes Optional Parameters</span></span>](./how-to-overload-a-procedure-that-takes-optional-parameters.md)
- [<span data-ttu-id="198b5-152">Guide pratique pour Surcharger une procédure qui accepte un nombre indéfini de paramètres</span><span class="sxs-lookup"><span data-stu-id="198b5-152">How to: Overload a Procedure that Takes an Indefinite Number of Parameters</span></span>](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [<span data-ttu-id="198b5-153">Considérations sur les surcharges de procédures</span><span class="sxs-lookup"><span data-stu-id="198b5-153">Considerations in Overloading Procedures</span></span>](./considerations-in-overloading-procedures.md)
- [<span data-ttu-id="198b5-154">Overloads</span><span class="sxs-lookup"><span data-stu-id="198b5-154">Overloads</span></span>](../../../../visual-basic/language-reference/modifiers/overloads.md)
- [<span data-ttu-id="198b5-155">Méthodes d’extension</span><span class="sxs-lookup"><span data-stu-id="198b5-155">Extension Methods</span></span>](./extension-methods.md)
