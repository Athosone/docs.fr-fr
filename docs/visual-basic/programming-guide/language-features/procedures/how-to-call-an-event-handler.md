---
title: 'Procédure : Appeler un gestionnaire d’événements en Visual Basic'
ms.date: 07/20/2015
helpviewer_keywords:
- Visual Basic code, procedures
- event handlers [Visual Basic], calling
- event handlers
- procedures [Visual Basic], event handlers
- procedures [Visual Basic], calling
ms.assetid: 72e18ef8-144e-40df-a1f4-066a57271e28
ms.openlocfilehash: 3690d1c2eb8ece9059b8b25b5a14bef2021bc8f6
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59320169"
---
# <a name="how-to-call-an-event-handler-in-visual-basic"></a><span data-ttu-id="8883f-102">Procédure : Appeler un gestionnaire d’événements en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="8883f-102">How to: Call an Event Handler in Visual Basic</span></span>
<span data-ttu-id="8883f-103">Un *événement* est une action ou une occurrence, comme une souris, cliquez ou une limite de crédit dépassé, qui est reconnue par un composant de programme, et pour lequel vous pouvez écrire du code pour répondre.</span><span class="sxs-lookup"><span data-stu-id="8883f-103">An *event* is an action or occurrence — such as a mouse click or a credit limit exceeded — that is recognized by some program component, and for which you can write code to respond.</span></span> <span data-ttu-id="8883f-104">Un *Gestionnaire d’événements* est le code que vous écrivez pour répondre à un événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-104">An *event handler* is the code you write to respond to an event.</span></span>  
  
 <span data-ttu-id="8883f-105">Un gestionnaire d’événements en Visual Basic est un `Sub` procédure.</span><span class="sxs-lookup"><span data-stu-id="8883f-105">An event handler in Visual Basic is a `Sub` procedure.</span></span> <span data-ttu-id="8883f-106">Toutefois, vous ne normalement l’appelez pas la même façon que les autres `Sub` procédures.</span><span class="sxs-lookup"><span data-stu-id="8883f-106">However, you do not normally call it the same way as other `Sub` procedures.</span></span> <span data-ttu-id="8883f-107">Au lieu de cela, vous identifiez la procédure en tant que gestionnaire pour l’événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-107">Instead, you identify the procedure as a handler for the event.</span></span> <span data-ttu-id="8883f-108">Cela avec une [gère](../../../../visual-basic/language-reference/statements/handles-clause.md) clause et un [WithEvents](../../../../visual-basic/language-reference/modifiers/withevents.md) variable, ou avec un [AddHandler, instruction](../../../../visual-basic/language-reference/statements/addhandler-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8883f-108">You can do this either with a [Handles](../../../../visual-basic/language-reference/statements/handles-clause.md) clause and a [WithEvents](../../../../visual-basic/language-reference/modifiers/withevents.md) variable, or with an [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md).</span></span> <span data-ttu-id="8883f-109">À l’aide un `Handles` clause constitue la méthode par défaut pour déclarer un gestionnaire d’événements en Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="8883f-109">Using a `Handles` clause is the default way to declare an event handler in Visual Basic.</span></span> <span data-ttu-id="8883f-110">Il s’agit de la manière dont les gestionnaires d’événements sont écrits par les concepteurs lorsque vous programmez dans l’environnement de développement intégré (IDE).</span><span class="sxs-lookup"><span data-stu-id="8883f-110">This is the way the event handlers are written by the designers when you program in the integrated development environment (IDE).</span></span> <span data-ttu-id="8883f-111">La `AddHandler` instruction convient pour déclencher des événements dynamiquement au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="8883f-111">The `AddHandler` statement is suitable for raising events dynamically at run time.</span></span>  
  
 <span data-ttu-id="8883f-112">Lorsque l’événement se produit, Visual Basic appelle automatiquement la procédure de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="8883f-112">When the event occurs, Visual Basic automatically calls the event handler procedure.</span></span> <span data-ttu-id="8883f-113">Tout code qui a accès à l’événement peut déclencher celui-ci en exécutant une [RaiseEvent, instruction](../../../../visual-basic/language-reference/statements/raiseevent-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8883f-113">Any code that has access to the event can cause it to occur by executing a [RaiseEvent Statement](../../../../visual-basic/language-reference/statements/raiseevent-statement.md).</span></span>  
  
 <span data-ttu-id="8883f-114">Vous pouvez associer plusieurs gestionnaires d’événements avec le même événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-114">You can associate more than one event handler with the same event.</span></span> <span data-ttu-id="8883f-115">Dans certains cas, vous pouvez dissocier un gestionnaire d’un événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-115">In some cases you can dissociate a handler from an event.</span></span> <span data-ttu-id="8883f-116">Pour plus d'informations, consultez [Événements](../../../../visual-basic/programming-guide/language-features/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="8883f-116">For more information, see [Events](../../../../visual-basic/programming-guide/language-features/events/index.md).</span></span>  
  
### <a name="to-call-an-event-handler-using-handles-and-withevents"></a><span data-ttu-id="8883f-117">Pour appeler un gestionnaire d’événements à l’aide de Handles et WithEvents</span><span class="sxs-lookup"><span data-stu-id="8883f-117">To call an event handler using Handles and WithEvents</span></span>  
  
1. <span data-ttu-id="8883f-118">Assurez-vous que l’événement est déclaré avec un [Event, instruction](../../../../visual-basic/language-reference/statements/event-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8883f-118">Make sure the event is declared with an [Event Statement](../../../../visual-basic/language-reference/statements/event-statement.md).</span></span>  
  
2. <span data-ttu-id="8883f-119">Déclarez une variable d’objet au module ou de la classe de niveau, à l’aide de la [WithEvents](../../../../visual-basic/language-reference/modifiers/withevents.md) mot clé.</span><span class="sxs-lookup"><span data-stu-id="8883f-119">Declare an object variable at module or class level, using the [WithEvents](../../../../visual-basic/language-reference/modifiers/withevents.md) keyword.</span></span> <span data-ttu-id="8883f-120">Le `As` clause pour cette variable doit spécifier la classe qui déclenche l’événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-120">The `As` clause for this variable must specify the class that raises the event.</span></span>  
  
3. <span data-ttu-id="8883f-121">Dans la déclaration de la gestion des événements `Sub` procédure, ajoutez un [gère](../../../../visual-basic/language-reference/statements/handles-clause.md) clause qui spécifie le `WithEvents` variable et le nom de l’événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-121">In the declaration of the event-handling `Sub` procedure, add a [Handles](../../../../visual-basic/language-reference/statements/handles-clause.md) clause that specifies the `WithEvents` variable and the event name.</span></span>  
  
4. <span data-ttu-id="8883f-122">Lorsque l’événement se produit, Visual Basic appelle automatiquement la `Sub` procédure.</span><span class="sxs-lookup"><span data-stu-id="8883f-122">When the event occurs, Visual Basic automatically calls the `Sub` procedure.</span></span> <span data-ttu-id="8883f-123">Votre code peut utiliser un `RaiseEvent` instruction pour rendre l’événement se produit.</span><span class="sxs-lookup"><span data-stu-id="8883f-123">Your code can use a `RaiseEvent` statement to make the event occur.</span></span>  
  
     <span data-ttu-id="8883f-124">L’exemple suivant définit un événement et un `WithEvents` variable qui fait référence à la classe qui déclenche l’événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-124">The following example defines an event and a `WithEvents` variable that refers to the class that raises the event.</span></span> <span data-ttu-id="8883f-125">La gestion des événements `Sub` procédure utilise un `Handles` clause pour spécifier la classe et l’événement qu’elle gère.</span><span class="sxs-lookup"><span data-stu-id="8883f-125">The event-handling `Sub` procedure uses a `Handles` clause to specify the class and event it handles.</span></span>  
  
     [!code-vb[VbVbcnProcedures#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#4)]  
  
### <a name="to-call-an-event-handler-using-addhandler"></a><span data-ttu-id="8883f-126">Pour appeler un gestionnaire d’événements à l’aide de AddHandler</span><span class="sxs-lookup"><span data-stu-id="8883f-126">To call an event handler using AddHandler</span></span>  
  
1. <span data-ttu-id="8883f-127">Assurez-vous que l’événement est déclaré avec un `Event` instruction.</span><span class="sxs-lookup"><span data-stu-id="8883f-127">Make sure the event is declared with an `Event` statement.</span></span>  
  
2. <span data-ttu-id="8883f-128">Exécuter un [AddHandler, instruction](../../../../visual-basic/language-reference/statements/addhandler-statement.md) connecter dynamiquement la gestion des événements `Sub` procédure avec l’événement.</span><span class="sxs-lookup"><span data-stu-id="8883f-128">Execute an [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md) to dynamically connect the event-handling `Sub` procedure with the event.</span></span>  
  
3. <span data-ttu-id="8883f-129">Lorsque l’événement se produit, Visual Basic appelle automatiquement la `Sub` procédure.</span><span class="sxs-lookup"><span data-stu-id="8883f-129">When the event occurs, Visual Basic automatically calls the `Sub` procedure.</span></span> <span data-ttu-id="8883f-130">Votre code peut utiliser un `RaiseEvent` instruction pour rendre l’événement se produit.</span><span class="sxs-lookup"><span data-stu-id="8883f-130">Your code can use a `RaiseEvent` statement to make the event occur.</span></span>  
  
     <span data-ttu-id="8883f-131">L’exemple suivant définit un `Sub` procédure gère le <xref:System.Windows.Forms.Form.Closing> événement d’un formulaire.</span><span class="sxs-lookup"><span data-stu-id="8883f-131">The following example defines a `Sub` procedure to handle the <xref:System.Windows.Forms.Form.Closing> event of a form.</span></span> <span data-ttu-id="8883f-132">Il utilise ensuite le [AddHandler, instruction](../../../../visual-basic/language-reference/statements/addhandler-statement.md) pour associer le `catchClose` procédure comme gestionnaire d’événements pour <xref:System.Windows.Forms.Form.Closing>.</span><span class="sxs-lookup"><span data-stu-id="8883f-132">It then uses the [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md) to associate the `catchClose` procedure as an event handler for <xref:System.Windows.Forms.Form.Closing>.</span></span>  
  
     [!code-vb[VbVbcnProcedures#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#5)]  
  
     <span data-ttu-id="8883f-133">Vous pouvez dissocier un gestionnaire d’événements à partir d’un événement en exécutant la [RemoveHandler, instruction](../../../../visual-basic/language-reference/statements/removehandler-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8883f-133">You can dissociate an event handler from an event by executing the [RemoveHandler Statement](../../../../visual-basic/language-reference/statements/removehandler-statement.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8883f-134">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8883f-134">See also</span></span>

- [<span data-ttu-id="8883f-135">Procédures</span><span class="sxs-lookup"><span data-stu-id="8883f-135">Procedures</span></span>](./index.md)
- [<span data-ttu-id="8883f-136">Procédures Sub</span><span class="sxs-lookup"><span data-stu-id="8883f-136">Sub Procedures</span></span>](./sub-procedures.md)
- [<span data-ttu-id="8883f-137">Sub (instruction)</span><span class="sxs-lookup"><span data-stu-id="8883f-137">Sub Statement</span></span>](../../../../visual-basic/language-reference/statements/sub-statement.md)
- [<span data-ttu-id="8883f-138">AddressOf (opérateur)</span><span class="sxs-lookup"><span data-stu-id="8883f-138">AddressOf Operator</span></span>](../../../../visual-basic/language-reference/operators/addressof-operator.md)
- [<span data-ttu-id="8883f-139">Guide pratique pour Créer une procédure</span><span class="sxs-lookup"><span data-stu-id="8883f-139">How to: Create a Procedure</span></span>](./how-to-create-a-procedure.md)
- [<span data-ttu-id="8883f-140">Guide pratique pour Appeler une procédure qui ne retourne pas de valeur</span><span class="sxs-lookup"><span data-stu-id="8883f-140">How to: Call a Procedure that Does Not Return a Value</span></span>](./how-to-call-a-procedure-that-does-not-return-a-value.md)
